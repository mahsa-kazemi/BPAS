#include <bpas.h>
#include "../../../include/FFT/src/dft64.h"
#include "../../../include/FFT/src/dft_utils.h"

// GeneralizedFermatPrimeField* DFT_64(GeneralizedFermatPrimeField* A, GeneralizedFermatPrimeField* omegas){
//
//     DFT2(&A[0],&A[32]);
//     DFT2(&A[1],&A[33]);
//     DFT2(&A[2],&A[34]);
//     DFT2(&A[3],&A[35]);
//     DFT2(&A[4],&A[36]);
//     DFT2(&A[5],&A[37]);
//     DFT2(&A[6],&A[38]);
//     DFT2(&A[7],&A[39]);
//     DFT2(&A[8],&A[40]);
//     DFT2(&A[9],&A[41]);
//     DFT2(&A[10],&A[42]);
//     DFT2(&A[11],&A[43]);
//     DFT2(&A[12],&A[44]);
//     DFT2(&A[13],&A[45]);
//     DFT2(&A[14],&A[46]);
//     DFT2(&A[15],&A[47]);
//     DFT2(&A[16],&A[48]);
//     DFT2(&A[17],&A[49]);
//     DFT2(&A[18],&A[50]);
//     DFT2(&A[19],&A[51]);
//     DFT2(&A[20],&A[52]);
//     DFT2(&A[21],&A[53]);
//     DFT2(&A[22],&A[54]);
//     DFT2(&A[23],&A[55]);
//     DFT2(&A[24],&A[56]);
//     DFT2(&A[25],&A[57]);
//     DFT2(&A[26],&A[58]);
//     DFT2(&A[27],&A[59]);
//     DFT2(&A[28],&A[60]);
//     DFT2(&A[29],&A[61]);
//     DFT2(&A[30],&A[62]);
//     DFT2(&A[31],&A[63]);
//
//     //T_{2}^{4}
//     A[48] = A[48].MulPowR(16);//*omegas[16];
//     A[49] = A[49].MulPowR(16);//*omegas[16];
//     A[50] = A[50].MulPowR(16);//*omegas[16];
//     A[51] = A[51].MulPowR(16);//*omegas[16];
//     A[52] = A[52].MulPowR(16);//*omegas[16];
//     A[53] = A[53].MulPowR(16);//*omegas[16];
//     A[54] = A[54].MulPowR(16);//*omegas[16];
//     A[55] = A[55].MulPowR(16);//*omegas[16];
//     A[56] = A[56].MulPowR(16);//*omegas[16];
//     A[57] = A[57].MulPowR(16);//*omegas[16];
//     A[58] = A[58].MulPowR(16);//*omegas[16];
//     A[59] = A[59].MulPowR(16);//*omegas[16];
//     A[60] = A[60].MulPowR(16);//*omegas[16];
//     A[61] = A[61].MulPowR(16);//*omegas[16];
//     A[62] = A[62].MulPowR(16);//*omegas[16];
//     A[63] = A[63].MulPowR(16);//*omegas[16];
//
//     //I_{32} \tx DFT2
//     DFT2(&A[0],&A[16]);
//     DFT2(&A[1],&A[17]);
//     DFT2(&A[2],&A[18]);
//     DFT2(&A[3],&A[19]);
//     DFT2(&A[4],&A[20]);
//     DFT2(&A[5],&A[21]);
//     DFT2(&A[6],&A[22]);
//     DFT2(&A[7],&A[23]);
//     DFT2(&A[8],&A[24]);
//     DFT2(&A[9],&A[25]);
//     DFT2(&A[10],&A[26]);
//     DFT2(&A[11],&A[27]);
//     DFT2(&A[12],&A[28]);
//     DFT2(&A[13],&A[29]);
//     DFT2(&A[14],&A[30]);
//     DFT2(&A[15],&A[31]);
//     DFT2(&A[32],&A[48]);
//     DFT2(&A[33],&A[49]);
//     DFT2(&A[34],&A[50]);
//     DFT2(&A[35],&A[51]);
//     DFT2(&A[36],&A[52]);
//     DFT2(&A[37],&A[53]);
//     DFT2(&A[38],&A[54]);
//     DFT2(&A[39],&A[55]);
//     DFT2(&A[40],&A[56]);
//     DFT2(&A[41],&A[57]);
//     DFT2(&A[42],&A[58]);
//     DFT2(&A[43],&A[59]);
//     DFT2(&A[44],&A[60]);
//     DFT2(&A[45],&A[61]);
//     DFT2(&A[46],&A[62]);
//     DFT2(&A[47],&A[63]);
//
//     A[24] = A[24].MulPowR(16);//*omegas[16];
//     A[25] = A[25].MulPowR(16);//*omegas[16];
//     A[26] = A[26].MulPowR(16);//*omegas[16];
//     A[27] = A[27].MulPowR(16);//*omegas[16];
//     A[28] = A[28].MulPowR(16);//*omegas[16];
//     A[29] = A[29].MulPowR(16);//*omegas[16];
//     A[30] = A[30].MulPowR(16);//*omegas[16];
//     A[31] = A[31].MulPowR(16);//*omegas[16];
//     A[40] = A[40].MulPowR(8);//*omegas[8];
//     A[41] = A[41].MulPowR(8);//*omegas[8];
//     A[42] = A[42].MulPowR(8);//*omegas[8];
//     A[43] = A[43].MulPowR(8);//*omegas[8];
//     A[44] = A[44].MulPowR(8);//*omegas[8];
//     A[45] = A[45].MulPowR(8);//*omegas[8];
//     A[46] = A[46].MulPowR(8);//*omegas[8];
//     A[47] = A[47].MulPowR(8);//*omegas[8];
//     A[56] = A[56].MulPowR(24);//*omegas[24];
//     A[57] = A[57].MulPowR(24);//*omegas[24];
//     A[58] = A[58].MulPowR(24);//*omegas[24];
//     A[59] = A[59].MulPowR(24);//*omegas[24];
//     A[60] = A[60].MulPowR(24);//*omegas[24];
//     A[61] = A[61].MulPowR(24);//*omegas[24];
//     A[62] = A[62].MulPowR(24);//*omegas[24];
//     A[63] = A[63].MulPowR(24);//*omegas[24];
//
//     // I_{32} \tx DFT2
//     DFT2(&A[0],&A[8]);
//     DFT2(&A[1],&A[9]);
//     DFT2(&A[2],&A[10]);
//     DFT2(&A[3],&A[11]);
//     DFT2(&A[4],&A[12]);
//     DFT2(&A[5],&A[13]);
//     DFT2(&A[6],&A[14]);
//     DFT2(&A[7],&A[15]);
//     DFT2(&A[16],&A[24]);
//     DFT2(&A[17],&A[25]);
//     DFT2(&A[18],&A[26]);
//     DFT2(&A[19],&A[27]);
//     DFT2(&A[20],&A[28]);
//     DFT2(&A[21],&A[29]);
//     DFT2(&A[22],&A[30]);
//     DFT2(&A[23],&A[31]);
//     DFT2(&A[32],&A[40]);
//     DFT2(&A[33],&A[41]);
//     DFT2(&A[34],&A[42]);
//     DFT2(&A[35],&A[43]);
//     DFT2(&A[36],&A[44]);
//     DFT2(&A[37],&A[45]);
//     DFT2(&A[38],&A[46]);
//     DFT2(&A[39],&A[47]);
//     DFT2(&A[48],&A[56]);
//     DFT2(&A[49],&A[57]);
//     DFT2(&A[50],&A[58]);
//     DFT2(&A[51],&A[59]);
//     DFT2(&A[52],&A[60]);
//     DFT2(&A[53],&A[61]);
//     DFT2(&A[54],&A[62]);
//     DFT2(&A[55],&A[63]);
//
//     A[12] = A[12].MulPowR(16);//*omegas[16];
//     A[13] = A[13].MulPowR(16);//*omegas[16];
//     A[14] = A[14].MulPowR(16);//*omegas[16];
//     A[15] = A[15].MulPowR(16);//*omegas[16];
//     A[20] = A[20].MulPowR(8);//*omegas[8];
//     A[21] = A[21].MulPowR(8);//*omegas[8];
//     A[22] = A[22].MulPowR(8);//*omegas[8];
//     A[23] = A[23].MulPowR(8);//*omegas[8];
//     A[28] = A[28].MulPowR(24);//*omegas[24];
//     A[29] = A[29].MulPowR(24);//*omegas[24];
//     A[30] = A[30].MulPowR(24);//*omegas[24];
//     A[31] = A[31].MulPowR(24);//*omegas[24];
//     A[36] = A[36].MulPowR(4);//*omegas[4];
//     A[37] = A[37].MulPowR(4);//*omegas[4];
//     A[38] = A[38].MulPowR(4);//*omegas[4];
//     A[39] = A[39].MulPowR(4);//*omegas[4];
//     A[44] = A[44].MulPowR(20);//*omegas[20];
//     A[45] = A[45].MulPowR(20);//*omegas[20];
//     A[46] = A[46].MulPowR(20);//*omegas[20];
//     A[47] = A[47].MulPowR(20);//*omegas[20];
//     A[52] = A[52].MulPowR(12);//*omegas[12];
//     A[53] = A[53].MulPowR(12);//*omegas[12];
//     A[54] = A[54].MulPowR(12);//*omegas[12];
//     A[55] = A[55].MulPowR(12);//*omegas[12];
//     A[60] = A[60].MulPowR(28);//*omegas[28];
//     A[61] = A[61].MulPowR(28);//*omegas[28];
//     A[62] = A[62].MulPowR(28);//*omegas[28];
//     A[63] = A[63].MulPowR(28);//*omegas[28];
//
//     // I_{32} \ts DFT2
//     DFT2(&A[0],&A[4]);
//     DFT2(&A[1],&A[5]);
//     DFT2(&A[2],&A[6]);
//     DFT2(&A[3],&A[7]);
//     DFT2(&A[8],&A[12]);
//     DFT2(&A[9],&A[13]);
//     DFT2(&A[10],&A[14]);
//     DFT2(&A[11],&A[15]);
//     DFT2(&A[16],&A[20]);
//     DFT2(&A[17],&A[21]);
//     DFT2(&A[18],&A[22]);
//     DFT2(&A[19],&A[23]);
//     DFT2(&A[24],&A[28]);
//     DFT2(&A[25],&A[29]);
//     DFT2(&A[26],&A[30]);
//     DFT2(&A[27],&A[31]);
//     DFT2(&A[32],&A[36]);
//     DFT2(&A[33],&A[37]);
//     DFT2(&A[34],&A[38]);
//     DFT2(&A[35],&A[39]);
//     DFT2(&A[40],&A[44]);
//     DFT2(&A[41],&A[45]);
//     DFT2(&A[42],&A[46]);
//     DFT2(&A[43],&A[47]);
//     DFT2(&A[48],&A[52]);
//     DFT2(&A[49],&A[53]);
//     DFT2(&A[50],&A[54]);
//     DFT2(&A[51],&A[55]);
//     DFT2(&A[56],&A[60]);
//     DFT2(&A[57],&A[61]);
//     DFT2(&A[58],&A[62]);
//     DFT2(&A[59],&A[63]);
//
//     A[6] = A[6].MulPowR(16);//*omegas[16];
//     A[7] = A[7].MulPowR(16);//*omegas[16];
//     A[10] = A[10].MulPowR(8);//*omegas[8];
//     A[11] = A[11].MulPowR(8);//*omegas[8];
//     A[14] = A[14].MulPowR(24);//*omegas[24];
//     A[15] = A[15].MulPowR(24);//*omegas[24];
//     A[18] = A[18].MulPowR(4);//*omegas[4];
//     A[19] = A[19].MulPowR(4);//*omegas[4];
//     A[22] = A[22].MulPowR(20);//*omegas[20];
//     A[23] = A[23].MulPowR(20);//*omegas[20];
//     A[26] = A[26].MulPowR(12);//*omegas[12];
//     A[27] = A[27].MulPowR(12);//*omegas[12];
//     A[30] = A[30].MulPowR(28);//*omegas[28];
//     A[31] = A[31].MulPowR(28);//*omegas[28];
//     A[34] = A[34].MulPowR(2);//*omegas[2];
//     A[35] = A[35].MulPowR(2);//*omegas[2];
//     A[38] = A[38].MulPowR(18);//*omegas[18];
//     A[39] = A[39].MulPowR(18);//*omegas[18];
//     A[42] = A[42].MulPowR(10);//*omegas[10];
//     A[43] = A[43].MulPowR(10);//*omegas[10];
//     A[46] = A[46].MulPowR(26);//*omegas[26];
//     A[47] = A[47].MulPowR(26);//*omegas[26];
//     A[50] = A[50].MulPowR(6);//*omegas[6];
//     A[51] = A[51].MulPowR(6);//*omegas[6];
//     A[54] = A[54].MulPowR(22);//*omegas[22];
//     A[55] = A[55].MulPowR(22);//*omegas[22];
//     A[58] = A[58].MulPowR(14);//*omegas[14];
//     A[59] = A[59].MulPowR(14);//*omegas[14];
//     A[62] = A[62].MulPowR(30);//*omegas[30];
//     A[63] = A[63].MulPowR(30);//*omegas[30];
//
//     // I_{2} I_{16} \tx DFT2
//     DFT2(&A[0],&A[2]);
//     DFT2(&A[1],&A[3]);
//     DFT2(&A[4],&A[6]);
//     DFT2(&A[5],&A[7]);
//     DFT2(&A[8],&A[10]);
//     DFT2(&A[9],&A[11]);
//     DFT2(&A[12],&A[14]);
//     DFT2(&A[13],&A[15]);
//     DFT2(&A[16],&A[18]);
//     DFT2(&A[17],&A[19]);
//     DFT2(&A[20],&A[22]);
//     DFT2(&A[21],&A[23]);
//     DFT2(&A[24],&A[26]);
//     DFT2(&A[25],&A[27]);
//     DFT2(&A[28],&A[30]);
//     DFT2(&A[29],&A[31]);
//     DFT2(&A[32],&A[34]);
//     DFT2(&A[33],&A[35]);
//     DFT2(&A[36],&A[38]);
//     DFT2(&A[37],&A[39]);
//     DFT2(&A[40],&A[42]);
//     DFT2(&A[41],&A[43]);
//     DFT2(&A[44],&A[46]);
//     DFT2(&A[45],&A[47]);
//     DFT2(&A[48],&A[50]);
//     DFT2(&A[49],&A[51]);
//     DFT2(&A[52],&A[54]);
//     DFT2(&A[53],&A[55]);
//     DFT2(&A[56],&A[58]);
//     DFT2(&A[57],&A[59]);
//     DFT2(&A[60],&A[62]);
//     DFT2(&A[61],&A[63]);
//
//     A[3] = A[3].MulPowR(16);//*omegas[16];
//     A[5] = A[5].MulPowR(8);//*omegas[8];
//     A[7] = A[7].MulPowR(24);//*omegas[24];
//     A[9] = A[9].MulPowR(4);//*omegas[4];
//     A[11] = A[11].MulPowR(20);//*omegas[20];
//     A[13] = A[13].MulPowR(12);//*omegas[12];
//     A[15] = A[15].MulPowR(28);//*omegas[28];
//     A[17] = A[17].MulPowR(2);//*omegas[2];
//     A[19] = A[19].MulPowR(18);//*omegas[18];
//     A[21] = A[21].MulPowR(10);//*omegas[10];
//     A[23] = A[23].MulPowR(26);//*omegas[26];
//     A[25] = A[25].MulPowR(6);//*omegas[6];
//     A[27] = A[27].MulPowR(22);//*omegas[22];
//     A[29] = A[29].MulPowR(14);//*omegas[14];
//     A[31] = A[31].MulPowR(30);//*omegas[30];
//     A[33] = A[33].MulPowR(1);//*omegas[1];
//     A[35] = A[35].MulPowR(17);//*omegas[17];
//     A[37] = A[37].MulPowR(9);//*omegas[9];
//     A[39] = A[39].MulPowR(25);//*omegas[25];
//     A[41] = A[41].MulPowR(5);//*omegas[5];
//     A[43] = A[43].MulPowR(21);//*omegas[21];
//     A[45] = A[45].MulPowR(13);//*omegas[13];
//     A[47] = A[47].MulPowR(29);//*omegas[29];
//     A[49] = A[49].MulPowR(3);//*omegas[3];
//     A[51] = A[51].MulPowR(19);//*omegas[19];
//     A[53] = A[53].MulPowR(11);//*omegas[11];
//     A[55] = A[55].MulPowR(27);//*omegas[27];
//     A[57] = A[57].MulPowR(7);//*omegas[7];
//     A[59] = A[59].MulPowR(23);//*omegas[23];
//     A[61] = A[61].MulPowR(15);//*omegas[15];
//     A[63] = A[63].MulPowR(31);//*omegas[31];
//
//     DFT2(&A[0],&A[1]);
//     DFT2(&A[2],&A[3]);
//     DFT2(&A[4],&A[5]);
//     DFT2(&A[6],&A[7]);
//     DFT2(&A[8],&A[9]);
//     DFT2(&A[10],&A[11]);
//     DFT2(&A[12],&A[13]);
//     DFT2(&A[14],&A[15]);
//     DFT2(&A[16],&A[17]);
//     DFT2(&A[18],&A[19]);
//     DFT2(&A[20],&A[21]);
//     DFT2(&A[22],&A[23]);
//     DFT2(&A[24],&A[25]);
//     DFT2(&A[26],&A[27]);
//     DFT2(&A[28],&A[29]);
//     DFT2(&A[30],&A[31]);
//     DFT2(&A[32],&A[33]);
//     DFT2(&A[34],&A[35]);
//     DFT2(&A[36],&A[37]);
//     DFT2(&A[38],&A[39]);
//     DFT2(&A[40],&A[41]);
//     DFT2(&A[42],&A[43]);
//     DFT2(&A[44],&A[45]);
//     DFT2(&A[46],&A[47]);
//     DFT2(&A[48],&A[49]);
//     DFT2(&A[50],&A[51]);
//     DFT2(&A[52],&A[53]);
//     DFT2(&A[54],&A[55]);
//     DFT2(&A[56],&A[57]);
//     DFT2(&A[58],&A[59]);
//     DFT2(&A[60],&A[61]);
//     DFT2(&A[62],&A[63]);
//
//     // Final permutation
//     swap(&A[1],&A[32]);
//     swap(&A[2],&A[16]);
//     swap(&A[3],&A[48]);
//     swap(&A[4],&A[8]);
//     swap(&A[5],&A[40]);
//     swap(&A[6],&A[24]);
//     swap(&A[7],&A[56]);
//     swap(&A[9],&A[36]);
//     swap(&A[10],&A[20]);
//     swap(&A[11],&A[52]);
//     swap(&A[13],&A[44]);
//     swap(&A[14],&A[28]);
//     swap(&A[15],&A[60]);
//     swap(&A[17],&A[34]);
//     swap(&A[19],&A[50]);
//     swap(&A[21],&A[42]);
//     swap(&A[22],&A[26]);
//     swap(&A[23],&A[58]);
//     swap(&A[25],&A[38]);
//     swap(&A[27],&A[54]);
//     swap(&A[29],&A[46]);
//     swap(&A[31],&A[62]);
//     swap(&A[35],&A[49]);
//     swap(&A[37],&A[41]);
//     swap(&A[39],&A[57]);
//     swap(&A[43],&A[53]);
//     swap(&A[47],&A[61]);
//     swap(&A[55],&A[59]);
//
//     return A;
// }

// long int* DFT_64(long int* A, long int* omegas, long int prime,long long int R,long long int pP){
//
//     DFT2(&A[0],&A[32],prime);
//     DFT2(&A[1],&A[33],prime);
//     DFT2(&A[2],&A[34],prime);
//     DFT2(&A[3],&A[35],prime);
//     DFT2(&A[4],&A[36],prime);
//     DFT2(&A[5],&A[37],prime);
//     DFT2(&A[6],&A[38],prime);
//     DFT2(&A[7],&A[39],prime);
//     DFT2(&A[8],&A[40],prime);
//     DFT2(&A[9],&A[41],prime);
//     DFT2(&A[10],&A[42],prime);
//     DFT2(&A[11],&A[43],prime);
//     DFT2(&A[12],&A[44],prime);
//     DFT2(&A[13],&A[45],prime);
//     DFT2(&A[14],&A[46],prime);
//     DFT2(&A[15],&A[47],prime);
//     DFT2(&A[16],&A[48],prime);
//     DFT2(&A[17],&A[49],prime);
//     DFT2(&A[18],&A[50],prime);
//     DFT2(&A[19],&A[51],prime);
//     DFT2(&A[20],&A[52],prime);
//     DFT2(&A[21],&A[53],prime);
//     DFT2(&A[22],&A[54],prime);
//     DFT2(&A[23],&A[55],prime);
//     DFT2(&A[24],&A[56],prime);
//     DFT2(&A[25],&A[57],prime);
//     DFT2(&A[26],&A[58],prime);
//     DFT2(&A[27],&A[59],prime);
//     DFT2(&A[28],&A[60],prime);
//     DFT2(&A[29],&A[61],prime);
//     DFT2(&A[30],&A[62],prime);
//     DFT2(&A[31],&A[63],prime);
//
//     //T_{2}^{4}
//     A[48] = multi(A[48],omegas[16],prime,R,pP);
//     A[49] = multi(A[49],omegas[16],prime,R,pP);
//     A[50] = multi(A[50],omegas[16],prime,R,pP);
//     A[51] = multi(A[51],omegas[16],prime,R,pP);
//     A[52] = multi(A[52],omegas[16],prime,R,pP);
//     A[53] = multi(A[53],omegas[16],prime,R,pP);
//     A[54] = multi(A[54],omegas[16],prime,R,pP);
//     A[55] = multi(A[55],omegas[16],prime,R,pP);
//     A[56] = multi(A[56],omegas[16],prime,R,pP);
//     A[57] = multi(A[57],omegas[16],prime,R,pP);
//     A[58] = multi(A[58],omegas[16],prime,R,pP);
//     A[59] = multi(A[59],omegas[16],prime,R,pP);
//     A[60] = multi(A[60],omegas[16],prime,R,pP);
//     A[61] = multi(A[61],omegas[16],prime,R,pP);
//     A[62] = multi(A[62],omegas[16],prime,R,pP);
//     A[63] = multi(A[63],omegas[16],prime,R,pP);
//
//     //I_{32} \tx DFT2
//     DFT2(&A[0],&A[16],prime);
//     DFT2(&A[1],&A[17],prime);
//     DFT2(&A[2],&A[18],prime);
//     DFT2(&A[3],&A[19],prime);
//     DFT2(&A[4],&A[20],prime);
//     DFT2(&A[5],&A[21],prime);
//     DFT2(&A[6],&A[22],prime);
//     DFT2(&A[7],&A[23],prime);
//     DFT2(&A[8],&A[24],prime);
//     DFT2(&A[9],&A[25],prime);
//     DFT2(&A[10],&A[26],prime);
//     DFT2(&A[11],&A[27],prime);
//     DFT2(&A[12],&A[28],prime);
//     DFT2(&A[13],&A[29],prime);
//     DFT2(&A[14],&A[30],prime);
//     DFT2(&A[15],&A[31],prime);
//     DFT2(&A[32],&A[48],prime);
//     DFT2(&A[33],&A[49],prime);
//     DFT2(&A[34],&A[50],prime);
//     DFT2(&A[35],&A[51],prime);
//     DFT2(&A[36],&A[52],prime);
//     DFT2(&A[37],&A[53],prime);
//     DFT2(&A[38],&A[54],prime);
//     DFT2(&A[39],&A[55],prime);
//     DFT2(&A[40],&A[56],prime);
//     DFT2(&A[41],&A[57],prime);
//     DFT2(&A[42],&A[58],prime);
//     DFT2(&A[43],&A[59],prime);
//     DFT2(&A[44],&A[60],prime);
//     DFT2(&A[45],&A[61],prime);
//     DFT2(&A[46],&A[62],prime);
//     DFT2(&A[47],&A[63],prime);
//
//     A[24] = multi(A[24],omegas[16],prime,R,pP);
//     A[25] = multi(A[25],omegas[16],prime,R,pP);
//     A[26] = multi(A[26],omegas[16],prime,R,pP);
//     A[27] = multi(A[27],omegas[16],prime,R,pP);
//     A[28] = multi(A[28],omegas[16],prime,R,pP);
//     A[29] = multi(A[29],omegas[16],prime,R,pP);
//     A[30] = multi(A[30],omegas[16],prime,R,pP);
//     A[31] = multi(A[31],omegas[16],prime,R,pP);
//     A[40] = multi(A[40],omegas[8],prime,R,pP);
//     A[41] = multi(A[41],omegas[8],prime,R,pP);
//     A[42] = multi(A[42],omegas[8],prime,R,pP);
//     A[43] = multi(A[43],omegas[8],prime,R,pP);
//     A[44] = multi(A[44],omegas[8],prime,R,pP);
//     A[45] = multi(A[45],omegas[8],prime,R,pP);
//     A[46] = multi(A[46],omegas[8],prime,R,pP);
//     A[47] = multi(A[47],omegas[8],prime,R,pP);
//     A[56] = multi(A[56],omegas[24],prime,R,pP);
//     A[57] = multi(A[57],omegas[24],prime,R,pP);
//     A[58] = multi(A[58],omegas[24],prime,R,pP);
//     A[59] = multi(A[59],omegas[24],prime,R,pP);
//     A[60] = multi(A[60],omegas[24],prime,R,pP);
//     A[61] = multi(A[61],omegas[24],prime,R,pP);
//     A[62] = multi(A[62],omegas[24],prime,R,pP);
//     A[63] = multi(A[63],omegas[24],prime,R,pP);
//
//     // I_{32} \tx DFT2
//     DFT2(&A[0],&A[8],prime);
//     DFT2(&A[1],&A[9],prime);
//     DFT2(&A[2],&A[10],prime);
//     DFT2(&A[3],&A[11],prime);
//     DFT2(&A[4],&A[12],prime);
//     DFT2(&A[5],&A[13],prime);
//     DFT2(&A[6],&A[14],prime);
//     DFT2(&A[7],&A[15],prime);
//     DFT2(&A[16],&A[24],prime);
//     DFT2(&A[17],&A[25],prime);
//     DFT2(&A[18],&A[26],prime);
//     DFT2(&A[19],&A[27],prime);
//     DFT2(&A[20],&A[28],prime);
//     DFT2(&A[21],&A[29],prime);
//     DFT2(&A[22],&A[30],prime);
//     DFT2(&A[23],&A[31],prime);
//     DFT2(&A[32],&A[40],prime);
//     DFT2(&A[33],&A[41],prime);
//     DFT2(&A[34],&A[42],prime);
//     DFT2(&A[35],&A[43],prime);
//     DFT2(&A[36],&A[44],prime);
//     DFT2(&A[37],&A[45],prime);
//     DFT2(&A[38],&A[46],prime);
//     DFT2(&A[39],&A[47],prime);
//     DFT2(&A[48],&A[56],prime);
//     DFT2(&A[49],&A[57],prime);
//     DFT2(&A[50],&A[58],prime);
//     DFT2(&A[51],&A[59],prime);
//     DFT2(&A[52],&A[60],prime);
//     DFT2(&A[53],&A[61],prime);
//     DFT2(&A[54],&A[62],prime);
//     DFT2(&A[55],&A[63],prime);
//
//     A[12] = multi(A[12],omegas[16],prime,R,pP);
//     A[13] = multi(A[13],omegas[16],prime,R,pP);
//     A[14] = multi(A[14],omegas[16],prime,R,pP);
//     A[15] = multi(A[15],omegas[16],prime,R,pP);
//     A[20] = multi(A[20],omegas[8],prime,R,pP);
//     A[21] = multi(A[21],omegas[8],prime,R,pP);
//     A[22] = multi(A[22],omegas[8],prime,R,pP);
//     A[23] = multi(A[23],omegas[8],prime,R,pP);
//     A[28] = multi(A[28],omegas[24],prime,R,pP);
//     A[29] = multi(A[29],omegas[24],prime,R,pP);
//     A[30] = multi(A[30],omegas[24],prime,R,pP);
//     A[31] = multi(A[31],omegas[24],prime,R,pP);
//     A[36] = multi(A[36],omegas[4],prime,R,pP);
//     A[37] = multi(A[37],omegas[4],prime,R,pP);
//     A[38] = multi(A[38],omegas[4],prime,R,pP);
//     A[39] = multi(A[39],omegas[4],prime,R,pP);
//     A[44] = multi(A[44],omegas[20],prime,R,pP);
//     A[45] = multi(A[45],omegas[20],prime,R,pP);
//     A[46] = multi(A[46],omegas[20],prime,R,pP);
//     A[47] = multi(A[47],omegas[20],prime,R,pP);
//     A[52] = multi(A[52],omegas[12],prime,R,pP);
//     A[53] = multi(A[53],omegas[12],prime,R,pP);
//     A[54] = multi(A[54],omegas[12],prime,R,pP);
//     A[55] = multi(A[55],omegas[12],prime,R,pP);
//     A[60] = multi(A[60],omegas[28],prime,R,pP);
//     A[61] = multi(A[61],omegas[28],prime,R,pP);
//     A[62] = multi(A[62],omegas[28],prime,R,pP);
//     A[63] = multi(A[63],omegas[28],prime,R,pP);
//
//     // I_{32} \ts DFT2
//     DFT2(&A[0],&A[4],prime);
//     DFT2(&A[1],&A[5],prime);
//     DFT2(&A[2],&A[6],prime);
//     DFT2(&A[3],&A[7],prime);
//     DFT2(&A[8],&A[12],prime);
//     DFT2(&A[9],&A[13],prime);
//     DFT2(&A[10],&A[14],prime);
//     DFT2(&A[11],&A[15],prime);
//     DFT2(&A[16],&A[20],prime);
//     DFT2(&A[17],&A[21],prime);
//     DFT2(&A[18],&A[22],prime);
//     DFT2(&A[19],&A[23],prime);
//     DFT2(&A[24],&A[28],prime);
//     DFT2(&A[25],&A[29],prime);
//     DFT2(&A[26],&A[30],prime);
//     DFT2(&A[27],&A[31],prime);
//     DFT2(&A[32],&A[36],prime);
//     DFT2(&A[33],&A[37],prime);
//     DFT2(&A[34],&A[38],prime);
//     DFT2(&A[35],&A[39],prime);
//     DFT2(&A[40],&A[44],prime);
//     DFT2(&A[41],&A[45],prime);
//     DFT2(&A[42],&A[46],prime);
//     DFT2(&A[43],&A[47],prime);
//     DFT2(&A[48],&A[52],prime);
//     DFT2(&A[49],&A[53],prime);
//     DFT2(&A[50],&A[54],prime);
//     DFT2(&A[51],&A[55],prime);
//     DFT2(&A[56],&A[60],prime);
//     DFT2(&A[57],&A[61],prime);
//     DFT2(&A[58],&A[62],prime);
//     DFT2(&A[59],&A[63],prime);
//
//     A[6] = multi(A[6],omegas[16],prime,R,pP);
//     A[7] = multi(A[7],omegas[16],prime,R,pP);
//     A[10] = multi(A[10],omegas[8],prime,R,pP);
//     A[11] = multi(A[11],omegas[8],prime,R,pP);
//     A[14] = multi(A[14],omegas[24],prime,R,pP);
//     A[15] = multi(A[15],omegas[24],prime,R,pP);
//     A[18] = multi(A[18],omegas[4],prime,R,pP);
//     A[19] = multi(A[19],omegas[4],prime,R,pP);
//     A[22] = multi(A[22],omegas[20],prime,R,pP);
//     A[23] = multi(A[23],omegas[20],prime,R,pP);
//     A[26] = multi(A[26],omegas[12],prime,R,pP);
//     A[27] = multi(A[27],omegas[12],prime,R,pP);
//     A[30] = multi(A[30],omegas[28],prime,R,pP);
//     A[31] = multi(A[31],omegas[28],prime,R,pP);
//     A[34] = multi(A[34],omegas[2],prime,R,pP);
//     A[35] = multi(A[35],omegas[2],prime,R,pP);
//     A[38] = multi(A[38],omegas[18],prime,R,pP);
//     A[39] = multi(A[39],omegas[18],prime,R,pP);
//     A[42] = multi(A[42],omegas[10],prime,R,pP);
//     A[43] = multi(A[43],omegas[10],prime,R,pP);
//     A[46] = multi(A[46],omegas[26],prime,R,pP);
//     A[47] = multi(A[47],omegas[26],prime,R,pP);
//     A[50] = multi(A[50],omegas[6],prime,R,pP);
//     A[51] = multi(A[51],omegas[6],prime,R,pP);
//     A[54] = multi(A[54],omegas[22],prime,R,pP);
//     A[55] = multi(A[55],omegas[22],prime,R,pP);
//     A[58] = multi(A[58],omegas[14],prime,R,pP);
//     A[59] = multi(A[59],omegas[14],prime,R,pP);
//     A[62] = multi(A[62],omegas[30],prime,R,pP);
//     A[63] = multi(A[63],omegas[30],prime,R,pP);
//
//     // I_{2} I_{16} \tx DFT2
//     DFT2(&A[0],&A[2],prime);
//     DFT2(&A[1],&A[3],prime);
//     DFT2(&A[4],&A[6],prime);
//     DFT2(&A[5],&A[7],prime);
//     DFT2(&A[8],&A[10],prime);
//     DFT2(&A[9],&A[11],prime);
//     DFT2(&A[12],&A[14],prime);
//     DFT2(&A[13],&A[15],prime);
//     DFT2(&A[16],&A[18],prime);
//     DFT2(&A[17],&A[19],prime);
//     DFT2(&A[20],&A[22],prime);
//     DFT2(&A[21],&A[23],prime);
//     DFT2(&A[24],&A[26],prime);
//     DFT2(&A[25],&A[27],prime);
//     DFT2(&A[28],&A[30],prime);
//     DFT2(&A[29],&A[31],prime);
//     DFT2(&A[32],&A[34],prime);
//     DFT2(&A[33],&A[35],prime);
//     DFT2(&A[36],&A[38],prime);
//     DFT2(&A[37],&A[39],prime);
//     DFT2(&A[40],&A[42],prime);
//     DFT2(&A[41],&A[43],prime);
//     DFT2(&A[44],&A[46],prime);
//     DFT2(&A[45],&A[47],prime);
//     DFT2(&A[48],&A[50],prime);
//     DFT2(&A[49],&A[51],prime);
//     DFT2(&A[52],&A[54],prime);
//     DFT2(&A[53],&A[55],prime);
//     DFT2(&A[56],&A[58],prime);
//     DFT2(&A[57],&A[59],prime);
//     DFT2(&A[60],&A[62],prime);
//     DFT2(&A[61],&A[63],prime);
//
//     A[3] = multi(A[3],omegas[16],prime,R,pP);
//     A[5] = multi(A[5],omegas[8],prime,R,pP);
//     A[7] = multi(A[7],omegas[24],prime,R,pP);
//     A[9] = multi(A[9],omegas[4],prime,R,pP);
//     A[11] = multi(A[11],omegas[20],prime,R,pP);
//     A[13] = multi(A[13],omegas[12],prime,R,pP);
//     A[15] = multi(A[15],omegas[28],prime,R,pP);
//     A[17] = multi(A[17],omegas[2],prime,R,pP);
//     A[19] = multi(A[19],omegas[18],prime,R,pP);
//     A[21] = multi(A[21],omegas[10],prime,R,pP);
//     A[23] = multi(A[23],omegas[26],prime,R,pP);
//     A[25] = multi(A[25],omegas[6],prime,R,pP);
//     A[27] = multi(A[27],omegas[22],prime,R,pP);
//     A[29] = multi(A[29],omegas[14],prime,R,pP);
//     A[31] = multi(A[31],omegas[30],prime,R,pP);
//     A[33] = multi(A[33],omegas[1],prime,R,pP);
//     A[35] = multi(A[35],omegas[17],prime,R,pP);
//     A[37] = multi(A[37],omegas[9],prime,R,pP);
//     A[39] = multi(A[39],omegas[25],prime,R,pP);
//     A[41] = multi(A[41],omegas[5],prime,R,pP);
//     A[43] = multi(A[43],omegas[21],prime,R,pP);
//     A[45] = multi(A[45],omegas[13],prime,R,pP);
//     A[47] = multi(A[47],omegas[29],prime,R,pP);
//     A[49] = multi(A[49],omegas[3],prime,R,pP);
//     A[51] = multi(A[51],omegas[19],prime,R,pP);
//     A[53] = multi(A[53],omegas[11],prime,R,pP);
//     A[55] = multi(A[55],omegas[27],prime,R,pP);
//     A[57] = multi(A[57],omegas[7],prime,R,pP);
//     A[59] = multi(A[59],omegas[23],prime,R,pP);
//     A[61] = multi(A[61],omegas[15],prime,R,pP);
//     A[63] = multi(A[63],omegas[31],prime,R,pP);
//
//     DFT2(&A[0],&A[1],prime);
//     DFT2(&A[2],&A[3],prime);
//     DFT2(&A[4],&A[5],prime);
//     DFT2(&A[6],&A[7],prime);
//     DFT2(&A[8],&A[9],prime);
//     DFT2(&A[10],&A[11],prime);
//     DFT2(&A[12],&A[13],prime);
//     DFT2(&A[14],&A[15],prime);
//     DFT2(&A[16],&A[17],prime);
//     DFT2(&A[18],&A[19],prime);
//     DFT2(&A[20],&A[21],prime);
//     DFT2(&A[22],&A[23],prime);
//     DFT2(&A[24],&A[25],prime);
//     DFT2(&A[26],&A[27],prime);
//     DFT2(&A[28],&A[29],prime);
//     DFT2(&A[30],&A[31],prime);
//     DFT2(&A[32],&A[33],prime);
//     DFT2(&A[34],&A[35],prime);
//     DFT2(&A[36],&A[37],prime);
//     DFT2(&A[38],&A[39],prime);
//     DFT2(&A[40],&A[41],prime);
//     DFT2(&A[42],&A[43],prime);
//     DFT2(&A[44],&A[45],prime);
//     DFT2(&A[46],&A[47],prime);
//     DFT2(&A[48],&A[49],prime);
//     DFT2(&A[50],&A[51],prime);
//     DFT2(&A[52],&A[53],prime);
//     DFT2(&A[54],&A[55],prime);
//     DFT2(&A[56],&A[57],prime);
//     DFT2(&A[58],&A[59],prime);
//     DFT2(&A[60],&A[61],prime);
//     DFT2(&A[62],&A[63],prime);
//
//     // Final permutation
//     swap(&A[1],&A[32]);
//     swap(&A[2],&A[16]);
//     swap(&A[3],&A[48]);
//     swap(&A[4],&A[8]);
//     swap(&A[5],&A[40]);
//     swap(&A[6],&A[24]);
//     swap(&A[7],&A[56]);
//     swap(&A[9],&A[36]);
//     swap(&A[10],&A[20]);
//     swap(&A[11],&A[52]);
//     swap(&A[13],&A[44]);
//     swap(&A[14],&A[28]);
//     swap(&A[15],&A[60]);
//     swap(&A[17],&A[34]);
//     swap(&A[19],&A[50]);
//     swap(&A[21],&A[42]);
//     swap(&A[22],&A[26]);
//     swap(&A[23],&A[58]);
//     swap(&A[25],&A[38]);
//     swap(&A[27],&A[54]);
//     swap(&A[29],&A[46]);
//     swap(&A[31],&A[62]);
//     swap(&A[35],&A[49]);
//     swap(&A[37],&A[41]);
//     swap(&A[39],&A[57]);
//     swap(&A[43],&A[53]);
//     swap(&A[47],&A[61]);
//     swap(&A[55],&A[59]);
//
//     return A;
// }

template<class FiniteField>
FiniteField* DFT_64(FiniteField* A, FiniteField* omegas){

    DFT2(&A[0],&A[32]);
    DFT2(&A[1],&A[33]);
    DFT2(&A[2],&A[34]);
    DFT2(&A[3],&A[35]);
    DFT2(&A[4],&A[36]);
    DFT2(&A[5],&A[37]);
    DFT2(&A[6],&A[38]);
    DFT2(&A[7],&A[39]);
    DFT2(&A[8],&A[40]);
    DFT2(&A[9],&A[41]);
    DFT2(&A[10],&A[42]);
    DFT2(&A[11],&A[43]);
    DFT2(&A[12],&A[44]);
    DFT2(&A[13],&A[45]);
    DFT2(&A[14],&A[46]);
    DFT2(&A[15],&A[47]);
    DFT2(&A[16],&A[48]);
    DFT2(&A[17],&A[49]);
    DFT2(&A[18],&A[50]);
    DFT2(&A[19],&A[51]);
    DFT2(&A[20],&A[52]);
    DFT2(&A[21],&A[53]);
    DFT2(&A[22],&A[54]);
    DFT2(&A[23],&A[55]);
    DFT2(&A[24],&A[56]);
    DFT2(&A[25],&A[57]);
    DFT2(&A[26],&A[58]);
    DFT2(&A[27],&A[59]);
    DFT2(&A[28],&A[60]);
    DFT2(&A[29],&A[61]);
    DFT2(&A[30],&A[62]);
    DFT2(&A[31],&A[63]);

    //T_{2}^{4}
    A[48] = A[48]*omegas[16];
    A[49] = A[49]*omegas[16];
    A[50] = A[50]*omegas[16];
    A[51] = A[51]*omegas[16];
    A[52] = A[52]*omegas[16];
    A[53] = A[53]*omegas[16];
    A[54] = A[54]*omegas[16];
    A[55] = A[55]*omegas[16];
    A[56] = A[56]*omegas[16];
    A[57] = A[57]*omegas[16];
    A[58] = A[58]*omegas[16];
    A[59] = A[59]*omegas[16];
    A[60] = A[60]*omegas[16];
    A[61] = A[61]*omegas[16];
    A[62] = A[62]*omegas[16];
    A[63] = A[63]*omegas[16];

    //I_{32} \tx DFT2
    DFT2(&A[0],&A[16]);
    DFT2(&A[1],&A[17]);
    DFT2(&A[2],&A[18]);
    DFT2(&A[3],&A[19]);
    DFT2(&A[4],&A[20]);
    DFT2(&A[5],&A[21]);
    DFT2(&A[6],&A[22]);
    DFT2(&A[7],&A[23]);
    DFT2(&A[8],&A[24]);
    DFT2(&A[9],&A[25]);
    DFT2(&A[10],&A[26]);
    DFT2(&A[11],&A[27]);
    DFT2(&A[12],&A[28]);
    DFT2(&A[13],&A[29]);
    DFT2(&A[14],&A[30]);
    DFT2(&A[15],&A[31]);
    DFT2(&A[32],&A[48]);
    DFT2(&A[33],&A[49]);
    DFT2(&A[34],&A[50]);
    DFT2(&A[35],&A[51]);
    DFT2(&A[36],&A[52]);
    DFT2(&A[37],&A[53]);
    DFT2(&A[38],&A[54]);
    DFT2(&A[39],&A[55]);
    DFT2(&A[40],&A[56]);
    DFT2(&A[41],&A[57]);
    DFT2(&A[42],&A[58]);
    DFT2(&A[43],&A[59]);
    DFT2(&A[44],&A[60]);
    DFT2(&A[45],&A[61]);
    DFT2(&A[46],&A[62]);
    DFT2(&A[47],&A[63]);

    A[24] = A[24]*omegas[16];
    A[25] = A[25]*omegas[16];
    A[26] = A[26]*omegas[16];
    A[27] = A[27]*omegas[16];
    A[28] = A[28]*omegas[16];
    A[29] = A[29]*omegas[16];
    A[30] = A[30]*omegas[16];
    A[31] = A[31]*omegas[16];
    A[40] = A[40]*omegas[8];
    A[41] = A[41]*omegas[8];
    A[42] = A[42]*omegas[8];
    A[43] = A[43]*omegas[8];
    A[44] = A[44]*omegas[8];
    A[45] = A[45]*omegas[8];
    A[46] = A[46]*omegas[8];
    A[47] = A[47]*omegas[8];
    A[56] = A[56]*omegas[24];
    A[57] = A[57]*omegas[24];
    A[58] = A[58]*omegas[24];
    A[59] = A[59]*omegas[24];
    A[60] = A[60]*omegas[24];
    A[61] = A[61]*omegas[24];
    A[62] = A[62]*omegas[24];
    A[63] = A[63]*omegas[24];

    // I_{32} \tx DFT2
    DFT2(&A[0],&A[8]);
    DFT2(&A[1],&A[9]);
    DFT2(&A[2],&A[10]);
    DFT2(&A[3],&A[11]);
    DFT2(&A[4],&A[12]);
    DFT2(&A[5],&A[13]);
    DFT2(&A[6],&A[14]);
    DFT2(&A[7],&A[15]);
    DFT2(&A[16],&A[24]);
    DFT2(&A[17],&A[25]);
    DFT2(&A[18],&A[26]);
    DFT2(&A[19],&A[27]);
    DFT2(&A[20],&A[28]);
    DFT2(&A[21],&A[29]);
    DFT2(&A[22],&A[30]);
    DFT2(&A[23],&A[31]);
    DFT2(&A[32],&A[40]);
    DFT2(&A[33],&A[41]);
    DFT2(&A[34],&A[42]);
    DFT2(&A[35],&A[43]);
    DFT2(&A[36],&A[44]);
    DFT2(&A[37],&A[45]);
    DFT2(&A[38],&A[46]);
    DFT2(&A[39],&A[47]);
    DFT2(&A[48],&A[56]);
    DFT2(&A[49],&A[57]);
    DFT2(&A[50],&A[58]);
    DFT2(&A[51],&A[59]);
    DFT2(&A[52],&A[60]);
    DFT2(&A[53],&A[61]);
    DFT2(&A[54],&A[62]);
    DFT2(&A[55],&A[63]);

    A[12] = A[12]*omegas[16];
    A[13] = A[13]*omegas[16];
    A[14] = A[14]*omegas[16];
    A[15] = A[15]*omegas[16];
    A[20] = A[20]*omegas[8];
    A[21] = A[21]*omegas[8];
    A[22] = A[22]*omegas[8];
    A[23] = A[23]*omegas[8];
    A[28] = A[28]*omegas[24];
    A[29] = A[29]*omegas[24];
    A[30] = A[30]*omegas[24];
    A[31] = A[31]*omegas[24];
    A[36] = A[36]*omegas[4];
    A[37] = A[37]*omegas[4];
    A[38] = A[38]*omegas[4];
    A[39] = A[39]*omegas[4];
    A[44] = A[44]*omegas[20];
    A[45] = A[45]*omegas[20];
    A[46] = A[46]*omegas[20];
    A[47] = A[47]*omegas[20];
    A[52] = A[52]*omegas[12];
    A[53] = A[53]*omegas[12];
    A[54] = A[54]*omegas[12];
    A[55] = A[55]*omegas[12];
    A[60] = A[60]*omegas[28];
    A[61] = A[61]*omegas[28];
    A[62] = A[62]*omegas[28];
    A[63] = A[63]*omegas[28];

    // I_{32} \ts DFT2
    DFT2(&A[0],&A[4]);
    DFT2(&A[1],&A[5]);
    DFT2(&A[2],&A[6]);
    DFT2(&A[3],&A[7]);
    DFT2(&A[8],&A[12]);
    DFT2(&A[9],&A[13]);
    DFT2(&A[10],&A[14]);
    DFT2(&A[11],&A[15]);
    DFT2(&A[16],&A[20]);
    DFT2(&A[17],&A[21]);
    DFT2(&A[18],&A[22]);
    DFT2(&A[19],&A[23]);
    DFT2(&A[24],&A[28]);
    DFT2(&A[25],&A[29]);
    DFT2(&A[26],&A[30]);
    DFT2(&A[27],&A[31]);
    DFT2(&A[32],&A[36]);
    DFT2(&A[33],&A[37]);
    DFT2(&A[34],&A[38]);
    DFT2(&A[35],&A[39]);
    DFT2(&A[40],&A[44]);
    DFT2(&A[41],&A[45]);
    DFT2(&A[42],&A[46]);
    DFT2(&A[43],&A[47]);
    DFT2(&A[48],&A[52]);
    DFT2(&A[49],&A[53]);
    DFT2(&A[50],&A[54]);
    DFT2(&A[51],&A[55]);
    DFT2(&A[56],&A[60]);
    DFT2(&A[57],&A[61]);
    DFT2(&A[58],&A[62]);
    DFT2(&A[59],&A[63]);

    A[6] = A[6]*omegas[16];
    A[7] = A[7]*omegas[16];
    A[10] = A[10]*omegas[8];
    A[11] = A[11]*omegas[8];
    A[14] = A[14]*omegas[24];
    A[15] = A[15]*omegas[24];
    A[18] = A[18]*omegas[4];
    A[19] = A[19]*omegas[4];
    A[22] = A[22]*omegas[20];
    A[23] = A[23]*omegas[20];
    A[26] = A[26]*omegas[12];
    A[27] = A[27]*omegas[12];
    A[30] = A[30]*omegas[28];
    A[31] = A[31]*omegas[28];
    A[34] = A[34]*omegas[2];
    A[35] = A[35]*omegas[2];
    A[38] = A[38]*omegas[18];
    A[39] = A[39]*omegas[18];
    A[42] = A[42]*omegas[10];
    A[43] = A[43]*omegas[10];
    A[46] = A[46]*omegas[26];
    A[47] = A[47]*omegas[26];
    A[50] = A[50]*omegas[6];
    A[51] = A[51]*omegas[6];
    A[54] = A[54]*omegas[22];
    A[55] = A[55]*omegas[22];
    A[58] = A[58]*omegas[14];
    A[59] = A[59]*omegas[14];
    A[62] = A[62]*omegas[30];
    A[63] = A[63]*omegas[30];

    // I_{2} I_{16} \tx DFT2
    DFT2(&A[0],&A[2]);
    DFT2(&A[1],&A[3]);
    DFT2(&A[4],&A[6]);
    DFT2(&A[5],&A[7]);
    DFT2(&A[8],&A[10]);
    DFT2(&A[9],&A[11]);
    DFT2(&A[12],&A[14]);
    DFT2(&A[13],&A[15]);
    DFT2(&A[16],&A[18]);
    DFT2(&A[17],&A[19]);
    DFT2(&A[20],&A[22]);
    DFT2(&A[21],&A[23]);
    DFT2(&A[24],&A[26]);
    DFT2(&A[25],&A[27]);
    DFT2(&A[28],&A[30]);
    DFT2(&A[29],&A[31]);
    DFT2(&A[32],&A[34]);
    DFT2(&A[33],&A[35]);
    DFT2(&A[36],&A[38]);
    DFT2(&A[37],&A[39]);
    DFT2(&A[40],&A[42]);
    DFT2(&A[41],&A[43]);
    DFT2(&A[44],&A[46]);
    DFT2(&A[45],&A[47]);
    DFT2(&A[48],&A[50]);
    DFT2(&A[49],&A[51]);
    DFT2(&A[52],&A[54]);
    DFT2(&A[53],&A[55]);
    DFT2(&A[56],&A[58]);
    DFT2(&A[57],&A[59]);
    DFT2(&A[60],&A[62]);
    DFT2(&A[61],&A[63]);

    A[3] = A[3]*omegas[16];
    A[5] = A[5]*omegas[8];
    A[7] = A[7]*omegas[24];
    A[9] = A[9]*omegas[4];
    A[11] = A[11]*omegas[20];
    A[13] = A[13]*omegas[12];
    A[15] = A[15]*omegas[28];
    A[17] = A[17]*omegas[2];
    A[19] = A[19]*omegas[18];
    A[21] = A[21]*omegas[10];
    A[23] = A[23]*omegas[26];
    A[25] = A[25]*omegas[6];
    A[27] = A[27]*omegas[22];
    A[29] = A[29]*omegas[14];
    A[31] = A[31]*omegas[30];
    A[33] = A[33]*omegas[1];
    A[35] = A[35]*omegas[17];
    A[37] = A[37]*omegas[9];
    A[39] = A[39]*omegas[25];
    A[41] = A[41]*omegas[5];
    A[43] = A[43]*omegas[21];
    A[45] = A[45]*omegas[13];
    A[47] = A[47]*omegas[29];
    A[49] = A[49]*omegas[3];
    A[51] = A[51]*omegas[19];
    A[53] = A[53]*omegas[11];
    A[55] = A[55]*omegas[27];
    A[57] = A[57]*omegas[7];
    A[59] = A[59]*omegas[23];
    A[61] = A[61]*omegas[15];
    A[63] = A[63]*omegas[31];

    DFT2(&A[0],&A[1]);
    DFT2(&A[2],&A[3]);
    DFT2(&A[4],&A[5]);
    DFT2(&A[6],&A[7]);
    DFT2(&A[8],&A[9]);
    DFT2(&A[10],&A[11]);
    DFT2(&A[12],&A[13]);
    DFT2(&A[14],&A[15]);
    DFT2(&A[16],&A[17]);
    DFT2(&A[18],&A[19]);
    DFT2(&A[20],&A[21]);
    DFT2(&A[22],&A[23]);
    DFT2(&A[24],&A[25]);
    DFT2(&A[26],&A[27]);
    DFT2(&A[28],&A[29]);
    DFT2(&A[30],&A[31]);
    DFT2(&A[32],&A[33]);
    DFT2(&A[34],&A[35]);
    DFT2(&A[36],&A[37]);
    DFT2(&A[38],&A[39]);
    DFT2(&A[40],&A[41]);
    DFT2(&A[42],&A[43]);
    DFT2(&A[44],&A[45]);
    DFT2(&A[46],&A[47]);
    DFT2(&A[48],&A[49]);
    DFT2(&A[50],&A[51]);
    DFT2(&A[52],&A[53]);
    DFT2(&A[54],&A[55]);
    DFT2(&A[56],&A[57]);
    DFT2(&A[58],&A[59]);
    DFT2(&A[60],&A[61]);
    DFT2(&A[62],&A[63]);

    // Final permutation
    swap(&A[1],&A[32]);
    swap(&A[2],&A[16]);
    swap(&A[3],&A[48]);
    swap(&A[4],&A[8]);
    swap(&A[5],&A[40]);
    swap(&A[6],&A[24]);
    swap(&A[7],&A[56]);
    swap(&A[9],&A[36]);
    swap(&A[10],&A[20]);
    swap(&A[11],&A[52]);
    swap(&A[13],&A[44]);
    swap(&A[14],&A[28]);
    swap(&A[15],&A[60]);
    swap(&A[17],&A[34]);
    swap(&A[19],&A[50]);
    swap(&A[21],&A[42]);
    swap(&A[22],&A[26]);
    swap(&A[23],&A[58]);
    swap(&A[25],&A[38]);
    swap(&A[27],&A[54]);
    swap(&A[29],&A[46]);
    swap(&A[31],&A[62]);
    swap(&A[35],&A[49]);
    swap(&A[37],&A[41]);
    swap(&A[39],&A[57]);
    swap(&A[43],&A[53]);
    swap(&A[47],&A[61]);
    swap(&A[55],&A[59]);

    return A;
}

template SmallPrimeField* DFT_64<SmallPrimeField>(SmallPrimeField* A,SmallPrimeField* omegas);
template BigPrimeField* DFT_64<BigPrimeField>(BigPrimeField* A,BigPrimeField* omegas);
